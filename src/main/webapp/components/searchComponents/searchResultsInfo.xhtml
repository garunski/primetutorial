<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">

<ui:composition>
    <!-- Search Results Info Box with Integrated Filters -->
    <div class="card mb-4">
        <!-- Results Summary Header -->
        <div class="card-header bg-primary text-white">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="mb-0">Search Results</h5>
                    <small>
                        <h:outputText value="Showing all jobs" rendered="#{empty param['cluster'] and empty param['pathway'] and empty param['education'] and empty param['category'] and empty param['artsHumanities'] and empty param['businessInfoSystems'] and empty param['engineeringTech'] and empty param['healthServices'] and empty param['architectureEngineering'] and empty param['computerMathematical'] and empty param['healthcarePractitioners'] and empty param['lifeSocialScience']}" />

                        <!-- Career filters -->
                        <h:outputText value="Showing jobs in #{param['cluster']} cluster" rendered="#{not empty param['cluster'] and empty param['pathway']}" />
                        <h:outputText value="Showing jobs in #{param['pathway']} pathway" rendered="#{not empty param['pathway']}" />

                        <!-- Category filter -->
                        <h:outputText value="Showing jobs in #{param['category']} category"
                                      rendered="#{not empty param['category'] and empty param['cluster'] and empty param['pathway'] and empty param['education']}" />
                        <h:outputText value=" in #{param['category']} category"
                                      rendered="#{not empty param['category'] and (not empty param['cluster'] or not empty param['pathway'] or not empty param['education'])}" />

                        <!-- Education level -->
                        <h:outputText value="Showing jobs with #{param['education']} education"
                                      rendered="#{not empty param['education'] and empty param['cluster'] and empty param['pathway'] and empty param['category']}" />
                        <h:outputText value=" and #{param['education']} education"
                                      rendered="#{not empty param['education'] and (not empty param['cluster'] or not empty param['pathway'] or not empty param['category'])}" />

                        <!-- Education clusters -->
                        <h:outputText value="Showing jobs in education clusters: "
                                      rendered="#{(empty param['cluster'] and empty param['pathway'] and empty param['education']) and (not empty param['artsHumanities'] or not empty param['businessInfoSystems'] or not empty param['engineeringTech'] or not empty param['healthServices'])}" />
                        <h:outputText value="Arts &amp; Humanities " rendered="#{not empty param['artsHumanities']}" />
                        <h:outputText value="Business &amp; Info Systems " rendered="#{not empty param['businessInfoSystems']}" />
                        <h:outputText value="Engineering &amp; Tech " rendered="#{not empty param['engineeringTech']}" />
                        <h:outputText value="Health Services " rendered="#{not empty param['healthServices']}" />

                        <!-- STEM disciplines -->
                        <h:outputText value="Showing jobs in STEM disciplines: "
                                      rendered="#{(empty param['cluster'] and empty param['pathway'] and empty param['education'] and empty param['artsHumanities'] and empty param['businessInfoSystems'] and empty param['engineeringTech'] and empty param['healthServices']) and (not empty param['architectureEngineering'] or not empty param['computerMathematical'] or not empty param['healthcarePractitioners'] or not empty param['lifeSocialScience'])}" />
                        <h:outputText value="Architecture &amp; Engineering " rendered="#{not empty param['architectureEngineering']}" />
                        <h:outputText value="Computer &amp; Mathematical " rendered="#{not empty param['computerMathematical']}" />
                        <h:outputText value="Healthcare Practitioners " rendered="#{not empty param['healthcarePractitioners']}" />
                        <h:outputText value="Life &amp; Social Science " rendered="#{not empty param['lifeSocialScience']}" />

                        <h:outputText value=" (#{jobService.totalFilteredResults} results found" />
                        <h:outputText value=", showing #{jobService.startResult}-#{jobService.endResult}" 
                                      rendered="#{jobService.totalPages > 1}" />
                        <h:outputText value=")" />
                    </small>
                </div>
                <div>
                    <h:commandButton value="Save Search"
                                   styleClass="btn btn-light btn-sm me-2"
                                   rendered="#{not empty param['cluster'] or not empty param['pathway'] or not empty param['education'] or not empty param['artsHumanities'] or not empty param['businessInfoSystems'] or not empty param['engineeringTech'] or not empty param['healthServices'] or not empty param['architectureEngineering'] or not empty param['computerMathematical'] or not empty param['healthcarePractitioners'] or not empty param['lifeSocialScience']}" />

                    <h:link outcome="occupationSearchRevised"
                          styleClass="btn btn-outline-light btn-sm"
                          rendered="#{not empty param['cluster'] or not empty param['pathway'] or not empty param['education'] or not empty param['artsHumanities'] or not empty param['businessInfoSystems'] or not empty param['engineeringTech'] or not empty param['healthServices'] or not empty param['architectureEngineering'] or not empty param['computerMathematical'] or not empty param['healthcarePractitioners'] or not empty param['lifeSocialScience']}">
                        <f:param name="page" value="1" />
                        <i class="bi bi-x-circle me-1"></i> Clear Filters
                    </h:link>
                </div>
            </div>
        </div>

        <!-- Horizontal Filters Panel -->
        <div class="card-body bg-light border-bottom">
            <div class="row g-4">
                <!-- Preparation Filter -->
                <div class="col-md-3">
                    <div>
                        <label class="form-label fw-semibold d-block mb-2">Preparation</label>
                        <select id="educationSelect"
                                class="form-select form-select-sm"
                                onchange="applyFilter('education', this.value)">
                            <option value="">Select One</option>
                            <option value="jobzone1">No Experience Required - Start Right Away</option>
                            <option value="jobzone2">Short-Term Training (Few Months)</option>
                            <option value="jobzone3">Moderate Training (1-2 Years)</option>
                            <option value="jobzone4">College Degree Required (4+ Years)</option>
                            <option value="jobzone5">Advanced Degree Required (6+ Years)</option>
                        </select>
                    </div>
                </div>

                <!-- Salary Filter -->
                <div class="col-md-3">
                    <div>
                        <label class="form-label fw-semibold d-block mb-2">Minimum Salary</label>
                        <div class="d-flex align-items-center mb-1">
                            <small class="text-muted me-2">$0</small>
                            <h:inputHidden id="salaryInput" value="#{searchFilterBean.salary}" />
                            <input type="range" id="salarySlider"
                                   class="form-range flex-grow-1 mx-2"
                                   min="0"
                                   max="100000"
                                   step="5000"
                                   value="#{searchFilterBean.salary}" />
                            <small class="text-muted ms-2">$100k+</small>
                        </div>
                        <small class="text-primary fw-semibold" id="salaryValue">$0</small>
                    </div>
                </div>

                <!-- Quick Filters -->
                <div class="col-md-3">
                    <div>
                        <label class="form-label fw-semibold d-block mb-2">Quick Filters</label>
                        <div class="d-flex flex-wrap gap-2">
                            <ui:include src="searchLink.xhtml">
                                <ui:param name="targetPage" value="#{param['page'] ne null ? param['page'] : '1'}" />
                                <ui:param name="enabled" value="true" />
                                <ui:param name="buttonText" value="Bright Outlook" />
                                <ui:param name="iconClass" value="#{not empty param['brightOutlook'] ? 'bi bi-check-circle-fill text-warning' : 'bi bi-circle text-warning'}" />
                                <ui:param name="styleClass" value="#{not empty param['brightOutlook'] ? 'btn-outline-warning bg-warning bg-opacity-10 text-dark' : 'btn-light border-secondary text-dark'} btn-sm rounded-pill px-3 py-2" />
                                <ui:param name="filterParam" value="brightOutlook" />
                            </ui:include>
                            
                            <ui:include src="searchLink.xhtml">
                                <ui:param name="targetPage" value="#{param['page'] ne null ? param['page'] : '1'}" />
                                <ui:param name="enabled" value="true" />
                                <ui:param name="buttonText" value="Green Jobs" />
                                <ui:param name="iconClass" value="#{not empty param['greenJobs'] ? 'bi bi-check-circle-fill text-success' : 'bi bi-circle text-success'}" />
                                <ui:param name="styleClass" value="#{not empty param['greenJobs'] ? 'btn-outline-success bg-success bg-opacity-10 text-dark' : 'btn-light border-secondary text-dark'} btn-sm rounded-pill px-3 py-2" />
                                <ui:param name="filterParam" value="greenJobs" />
                            </ui:include>
                            
                            <ui:include src="searchLink.xhtml">
                                <ui:param name="targetPage" value="#{param['page'] ne null ? param['page'] : '1'}" />
                                <ui:param name="enabled" value="true" />
                                <ui:param name="buttonText" value="Apprenticeship" />
                                <ui:param name="iconClass" value="#{not empty param['apprenticeship'] ? 'bi bi-check-circle-fill text-primary' : 'bi bi-circle text-primary'}" />
                                <ui:param name="styleClass" value="#{not empty param['apprenticeship'] ? 'btn-outline-primary bg-primary bg-opacity-10 text-dark' : 'btn-light border-secondary text-dark'} btn-sm rounded-pill px-3 py-2" />
                                <ui:param name="filterParam" value="apprenticeship" />
                            </ui:include>
                        </div>
                    </div>
                </div>

                <!-- Sort By Filter -->
                <div class="col-md-3">
                    <div>
                        <label class="form-label fw-semibold d-block mb-2">Sort By</label>
                        <select id="sortBySelect"
                                class="form-select form-select-sm"
                                onchange="applyFilter('sort', this.value)">
                            <option value="name">Name</option>
                            <option value="salary">Salary</option>
                            <option value="job_zone">Job Zone</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ui:composition>
</html>
